{% extends "base.html" %}

{% block title %}
	{% if lang == 'uz' %}Visa Kalkulyatori - Study Fans{% elif lang == 'ru' %}Калькулятор визы - Study Fans{% elif lang == 'tr' %}Vize Hesaplayıcı - Study Fans{% else %}Visa Calculator - Study Fans{% endif %}
{% endblock %}

{% block content %}

<div class="page-container" style="margin-top: 0; padding-top: 0;">
<!-- Top Section with Title -->
<section class="pt-6 pb-6 bg-white">
	<div class="max-w-7xl mx-auto px-6">
		<div class="flex items-start gap-4 mb-6">
			<!-- Title Section -->
			<div class="flex-1">
				<h1 class="text-2xl font-medium text-gray-900 mb-1" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif; letter-spacing: -0.02em;">
					{% if lang == 'uz' %}Visa Kalkulyatori{% elif lang == 'ru' %}Калькулятор визы{% elif lang == 'tr' %}Vize Hesaplayıcı{% else %}Visa Calculator{% endif %}
				</h1>
				<p class="text-sm text-gray-500 font-normal mt-0.5" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
					{% if lang == 'uz' %}Turkiya vizasi tugash sanasini hisoblang{% elif lang == 'ru' %}Рассчитайте дату окончания визы в Турции{% elif lang == 'tr' %}Türkiye vizesi bitiş tarihini hesaplayın{% else %}Calculate Turkey visa expiration date{% endif %}
				</p>
			</div>
		</div>
	</div>
</section>

<!-- Calculator Section -->
<section class="py-8 bg-white">
	<div class="max-w-4xl mx-auto px-6">
		<!-- Visa Calculator Card -->
		<div class="bg-white border border-gray-200 rounded-3xl p-8">
			<div class="flex items-center gap-3 mb-6">
				<div class="w-12 h-12 bg-blue-50 rounded-2xl flex items-center justify-center">
					<img src="{{ url_for('static', filename='calculator.svg') }}" alt="Calculator" class="w-7 h-7">
				</div>
				<h2 class="text-xl font-medium text-gray-900" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
					{% if lang == 'uz' %}Turkiya Vizasi Tugash Sanasi{% elif lang == 'ru' %}Дата окончания визы в Турции{% elif lang == 'tr' %}Türkiye Vizesi Bitiş Tarihi{% else %}Turkey Visa Expiration Date{% endif %}
				</h2>
			</div>
			
			<p class="text-sm text-gray-600 font-normal mb-6 leading-relaxed" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
				{% if lang == 'uz' %}Turkiya vizasi 90 kun davom etadi. Visa berilgan kunni kiriting va tugash sanasini bilib oling.{% elif lang == 'ru' %}Виза в Турцию действует 90 дней. Введите дату выдачи визы и узнайте дату окончания.{% elif lang == 'tr' %}Türkiye vizesi 90 gün geçerlidir. Vize verilme tarihini girin ve bitiş tarihini öğrenin.{% else %}Turkey visa is valid for 90 days. Enter the visa issue date and find out the expiration date.{% endif %}
			</p>
			
			<div class="space-y-6">
				<div>
					<label class="block text-sm font-medium text-gray-900 mb-2" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
						{% if lang == 'uz' %}Visa berilgan sana{% elif lang == 'ru' %}Дата выдачи визы{% elif lang == 'tr' %}Vize verilme tarihi{% else %}Visa Issue Date{% endif %}
					</label>
					<input type="date" id="visaIssueDate" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-sm text-gray-900 font-normal focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
					<p class="text-xs text-gray-500 font-normal mt-2" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
						{% if lang == 'uz' %}Vizangiz berilgan sanani tanlang{% elif lang == 'ru' %}Выберите дату выдачи вашей визы{% elif lang == 'tr' %}Vizenizin verildiği tarihi seçin{% else %}Select the date your visa was issued{% endif %}
					</p>
				</div>
				
				<button onclick="calculateVisaExpiration()" class="w-full px-6 py-3.5 bg-gray-900 text-white rounded-full text-sm font-medium hover:bg-gray-800 transition-colors" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
					{% if lang == 'uz' %}Hisobla{% elif lang == 'ru' %}Рассчитать{% elif lang == 'tr' %}Hesapla{% else %}Calculate{% endif %}
				</button>
				
				<!-- Result Section -->
				<div id="visaResult" class="hidden mt-6 p-6 bg-blue-50 border border-blue-200 rounded-2xl">
					<div class="flex items-start gap-3 mb-4">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600 flex-shrink-0 mt-0.5">
							<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
							<polyline points="22 4 12 14.01 9 11.01"/>
						</svg>
						<div class="flex-1">
							<h3 class="text-base font-medium text-gray-900 mb-2" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
								{% if lang == 'uz' %}Visa tugash sanasi{% elif lang == 'ru' %}Дата окончания визы{% elif lang == 'tr' %}Vize bitiş tarihi{% else %}Visa Expiration Date{% endif %}
							</h3>
							<div class="space-y-2">
								<div>
									<p class="text-xs text-gray-600 font-normal mb-1" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
										{% if lang == 'uz' %}Visa berilgan sana:{% elif lang == 'ru' %}Дата выдачи визы:{% elif lang == 'tr' %}Vize verilme tarihi:{% else %}Visa Issue Date:{% endif %}
									</p>
									<p id="issueDateDisplay" class="text-lg font-semibold text-gray-900" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;"></p>
								</div>
								<div class="pt-2 border-t border-blue-200">
									<p class="text-xs text-gray-600 font-normal mb-1" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
										{% if lang == 'uz' %}Visa tugash sanasi (90 kundan keyin):{% elif lang == 'ru' %}Дата окончания визы (через 90 дней):{% elif lang == 'tr' %}Vize bitiş tarihi (90 gün sonra):{% else %}Visa Expiration Date (after 90 days):{% endif %}
									</p>
									<p id="expirationDateDisplay" class="text-2xl font-bold text-blue-600" style="font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;"></p>
								</div>
								<div class="pt-2">
									<p class="text-xs text-gray-500 font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
										{% if lang == 'uz' %}⚠️ Eslatma: Visa muddati 90 kun. Tugash sanasidan oldin mamlakatni tark etish yoki vizani uzaytirish kerak.{% elif lang == 'ru' %}⚠️ Примечание: Срок действия визы 90 дней. Необходимо покинуть страну или продлить визу до даты окончания.{% elif lang == 'tr' %}⚠️ Not: Vize süresi 90 gündür. Bitiş tarihinden önce ülkeyi terk etmeli veya vizeyi uzatmalısınız.{% else %}⚠️ Note: Visa validity is 90 days. You must leave the country or extend your visa before the expiration date.{% endif %}
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
</div>

<script>
function calculateVisaExpiration() {
	const issueDateInput = document.getElementById('visaIssueDate');
	const issueDate = issueDateInput.value;
	const resultDiv = document.getElementById('visaResult');
	
	if (!issueDate) {
		alert('{% if lang == "uz" %}Iltimos, visa berilgan sanani tanlang{% elif lang == "ru" %}Пожалуйста, выберите дату выдачи визы{% elif lang == "tr" %}Lütfen vize verilme tarihini seçin{% else %}Please select the visa issue date{% endif %}');
		return;
	}
	
	// Parse the issue date
	const issue = new Date(issueDate);
	
	// Check if date is valid
	if (isNaN(issue.getTime())) {
		alert('{% if lang == "uz" %}Noto\'g\'ri sana kiritildi{% elif lang == "ru" %}Введена неверная дата{% elif lang == "tr" %}Geçersiz tarih girildi{% else %}Invalid date entered{% endif %}');
		return;
	}
	
	// Calculate expiration date (90 days later)
	const expiration = new Date(issue);
	expiration.setDate(expiration.getDate() + 90);
	
	// Format dates for display
	const formatDate = (date) => {
		const day = String(date.getDate()).padStart(2, '0');
		const month = String(date.getMonth() + 1).padStart(2, '0');
		const year = date.getFullYear();
		
		// Get day name
		const days = {
			uz: ['Yakshanba', 'Dushanba', 'Seshanba', 'Chorshanba', 'Payshanba', 'Juma', 'Shanba'],
			ru: ['Воскресенье', 'Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота'],
			tr: ['Pazar', 'Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi'],
			en: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
		};
		
		const langCode = '{{ lang }}';
		const dayName = days[langCode] ? days[langCode][date.getDay()] : days['en'][date.getDay()];
		
		// Get month name
		const months = {
			uz: ['Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'Iyun', 'Iyul', 'Avgust', 'Sentabr', 'Oktabr', 'Noyabr', 'Dekabr'],
			ru: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
			tr: ['Ocak', 'Şubat', 'Mart', 'Nisan', 'Mayıs', 'Haziran', 'Temmuz', 'Ağustos', 'Eylül', 'Ekim', 'Kasım', 'Aralık'],
			en: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
		};
		
		const monthName = months[langCode] ? months[langCode][date.getMonth()] : months['en'][date.getMonth()];
		
		return `${dayName}, ${day} ${monthName} ${year}`;
	};
	
	// Display results
	document.getElementById('issueDateDisplay').textContent = formatDate(issue);
	document.getElementById('expirationDateDisplay').textContent = formatDate(expiration);
	
	// Show result
	resultDiv.classList.remove('hidden');
	
	// Scroll to result
	resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}
</script>

{% endblock %}
