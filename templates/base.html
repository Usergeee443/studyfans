<!DOCTYPE html>
<html lang="{{ lang or 'en' }}">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="google-site-verification" content="EinBsymUm1s49XoVNlxurtFzc4doH46irPt_A0G8k9Y" />
	<!-- Favicon -->
	<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
	<link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
	<link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
	<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
	<link rel="icon" type="image/png" sizes="48x48" href="{{ url_for('static', filename='favicon.ico') }}">
	<link rel="apple-touch-icon" href="{{ url_for('static', filename='images/IMG_8320.JPG') }}">
	<link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/IMG_8320.JPG') }}">
	<meta name="msapplication-TileImage" content="{{ url_for('static', filename='favicon-32x32.png') }}">
	<meta name="msapplication-TileColor" content="#ff9015">
	<!-- Force favicon refresh -->
	<link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}?v=2" type="image/x-icon">
	<title>{% block title %}Study Fans - Educational Consulting{% endblock %}</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">

	<style>
		/* Base Styles */
		html, body {
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			background: white;
			overflow-x: hidden;
		}
		
		body {
			position: relative;
		}
		
		/* Custom Animations */
		@keyframes fade-in-up {
			from {
				opacity: 0;
				transform: translateY(30px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		@keyframes slide-in-left {
			from {
				opacity: 0;
				transform: translateX(-50px);
			}

			to {
				opacity: 1;
				transform: translateX(0);
			}
		}

		@keyframes slide-in-right {
			from {
				opacity: 0;
				transform: translateX(50px);
			}

			to {
				opacity: 1;
				transform: translateX(0);
			}
		}

		@keyframes fade-in {
			from {
				opacity: 0;
			}

			to {
				opacity: 1;
			}
		}

		@keyframes bounce-slow {
			0%, 20%, 50%, 80%, 100% {
				transform: translateY(0);
			}
			40% {
				transform: translateY(-10px);
			}
			60% {
				transform: translateY(-5px);
			}
		}

		@keyframes pulse {
			0% {
				transform: scale(1);
			}
			50% {
				transform: scale(1.05);
			}
			100% {
				transform: scale(1);
			}
		}

		/* Sidebar Base Styles */
		#sidebar {
			transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			will-change: width;
		}
		
		/* Sidebar Collapse Styles */
		.sidebar-collapsed {
			width: 72px !important;
		}
		
		.sidebar-text {
			transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1), margin 0.3s cubic-bezier(0.4, 0, 0.2, 1), padding 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			white-space: nowrap;
			overflow: hidden;
		}
		
		.sidebar-collapsed .sidebar-text {
			opacity: 0;
			width: 0;
			margin: 0;
			padding: 0;
		}
		
		.sidebar-link {
			padding-left: 3.5rem;
			padding-right: 0.75rem;
			transition: padding 0.3s cubic-bezier(0.4, 0, 0.2, 1), justify-content 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.sidebar-collapsed .sidebar-link {
			justify-content: center;
			padding-left: 0.75rem;
			padding-right: 0.75rem;
		}
		
		.sidebar-icon-wrapper {
			flex-shrink: 0;
			position: absolute;
			left: 0.75rem;
			width: 32px;
			height: 32px;
			margin: 0;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		
		.sidebar-collapsed .sidebar-icon-wrapper {
			left: 0.75rem;
			margin: 0;
		}
		
		.sidebar-logo {
			transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.sidebar-collapsed .sidebar-logo {
			opacity: 0;
			visibility: hidden;
			pointer-events: none;
		}
		
		.sidebar-logo-img {
			transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			padding: 0.25rem;
			max-width: 100%;
			max-height: 100%;
		}
		
		.sidebar-collapsed .sidebar-logo-img {
			opacity: 0;
			transform: scale(0.8);
			pointer-events: none;
		}
		
		.sidebar-icon {
			transition: all 0.2s ease;
			flex-shrink: 0;
		}
		
		.sidebar-toggle-btn {
			position: absolute;
			left: 0.75rem;
			right: auto;
			top: 50%;
			transform: translateY(-50%);
			transition: none;
			width: 32px;
			height: 32px;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		
		.sidebar-collapsed .sidebar-toggle-btn {
			left: 0.75rem;
			right: auto;
		}
		
		/* Toggle icon states */
		.sidebar-collapsed #toggle-icon-close {
			display: none;
		}
		
		.sidebar-collapsed #toggle-icon-open {
			display: block !important;
		}
		
		#sidebar:not(.sidebar-collapsed) #toggle-icon-open {
			display: none !important;
		}
		
		#sidebar:not(.sidebar-collapsed) #toggle-icon-close {
			display: block;
		}
		
		/* Top section - no border when collapsed, fixed height */
		.sidebar-top-section {
			transition: padding 0.3s cubic-bezier(0.4, 0, 0.2, 1), border 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		.sidebar-collapsed .sidebar-top-section {
			border-bottom: none !important;
			padding: 1rem;
		}
		
		/* No tooltip for collapsed sidebar - removed */
		
		/* Sidebar Link Styles - No Background, Only Text Color */
		.sidebar-link {
			transition: color 0.2s ease, padding 0.3s cubic-bezier(0.4, 0, 0.2, 1), justify-content 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			position: relative;
			display: flex;
			align-items: center;
		}
		
		.sidebar-link:hover {
			color: #2563eb !important;
		}
		
		.sidebar-link:hover .sidebar-icon {
			filter: brightness(0) saturate(100%) invert(40%) sepia(96%) saturate(2476%) hue-rotate(210deg) brightness(98%) contrast(96%);
		}
		
		.sidebar-link.active {
			color: #2563eb !important;
		}
		
		.sidebar-link.active .sidebar-icon {
			filter: brightness(0) saturate(100%) invert(40%) sepia(96%) saturate(2476%) hue-rotate(210deg) brightness(98%) contrast(96%);
		}
		
		/* Disable hover for disabled links */
		.sidebar-link.cursor-not-allowed:hover {
			color: rgb(156 163 175) !important;
		}
		
		.sidebar-link.cursor-not-allowed:hover .sidebar-icon {
			filter: none !important;
		}
		
		.sidebar-icon-wrapper {
			border-radius: 8px;
		}
		
		.sidebar-icon {
			transition: all 0.2s ease;
		}
		
		/* Page Container - Full Width */
		.page-container {
			background: white;
			min-height: calc(100vh - 200px);
			margin: 0;
			padding-top: 0;
			margin-top: 0;
			position: relative;
			z-index: 1;
		}
		
		/* Main Content - Space between sidebar and content */
		#main-content {
			margin-left: 224px; /* w-56 = 14rem = 224px */
			width: calc(100% - 224px);
			overflow-x: hidden;
			position: relative;
			z-index: 1;
			transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}
		
		/* Sidebar collapsed state */
		#main-content.sidebar-content-collapsed {
			margin-left: 72px;
			width: calc(100% - 72px);
		}
		
		@media (max-width: 768px) {
			.page-container {
				margin: 0;
				padding: 1rem;
				padding-top: 0;
				margin-top: 0;
				padding-bottom: 5rem; /* Space for bottom navigation */
			}
			
			#main-content {
				padding-bottom: 5rem; /* Space for bottom navigation */
				padding-top: 1rem; /* Minimal space for mobile logo */
				position: relative;
				z-index: 1;
				margin-left: 0 !important;
				width: 100% !important;
			}
			
			#main-content.sidebar-content-collapsed {
				margin-left: 0 !important;
				width: 100% !important;
			}
		}
		
		/* Desktop only - apply margin */
		@media (min-width: 768px) {
			#main-content {
				margin-left: 224px;
				width: calc(100% - 224px);
			}
			
			#main-content.sidebar-content-collapsed {
				margin-left: 72px;
				width: calc(100% - 72px);
			}
		}
		
		@keyframes rotate {
			from {
				transform: rotate(0deg);
			}
			to {
				transform: rotate(360deg);
			}
		}

		@keyframes float {
			0%, 100% {
				transform: translateY(0px);
			}
			50% {
				transform: translateY(-10px);
			}
		}

		@keyframes glow {
			0%, 100% {
				box-shadow: 0 0 5px rgba(255, 144, 21, 0.5);
			}
			50% {
				box-shadow: 0 0 20px rgba(255, 144, 21, 0.8), 0 0 30px rgba(255, 144, 21, 0.6);
			}
		}

		@keyframes shake {
			0%, 100% {
				transform: translateX(0);
			}
			25% {
				transform: translateX(-5px);
			}
			75% {
				transform: translateX(5px);
			}
		}

		@keyframes slide-in-left-continuous {
			0% {
				transform: translateX(-100%);
			}
			100% {
				transform: translateX(100vw);
			}
		}

		@keyframes slide-in-right-continuous {
			0% {
				transform: translateX(100%);
			}
			100% {
				transform: translateX(-100vw);
			}
		}

		@keyframes gentle-bounce {
			0%, 100% {
				transform: translateY(0px);
			}
			50% {
				transform: translateY(-8px);
			}
		}

		@keyframes gentle-rotate {
			0% {
				transform: rotate(0deg);
			}
			100% {
				transform: rotate(360deg);
			}
		}

		@keyframes gentle-scale {
			0%, 100% {
				transform: scale(1);
			}
			50% {
				transform: scale(1.05);
			}
		}

		@keyframes gentle-glow {
			0%, 100% {
				box-shadow: 0 0 5px rgba(255, 144, 21, 0.3);
			}
			50% {
				box-shadow: 0 0 20px rgba(255, 144, 21, 0.6);
			}
		}

		@keyframes wave {
			0%, 100% {
				transform: translateY(0px);
			}
			25% {
				transform: translateY(-5px);
			}
			75% {
				transform: translateY(5px);
			}
		}

		@keyframes scroll-left {
			0% {
				transform: translateX(0);
			}
			100% {
				transform: translateX(-50%);
			}
		}

		@keyframes scroll-right {
			0% {
				transform: translateX(-50%);
			}
			100% {
				transform: translateX(0);
			}
		}
		
		@keyframes scroll-up {
			0% {
				transform: translateY(0%);
			}
			100% {
				transform: translateY(-50%);
			}
		}
		
		@keyframes scroll-down {
			0% {
				transform: translateY(-50%);
			}
			100% {
				transform: translateY(0%);
			}
		}
		
		@keyframes scroll-horizontal {
			0% {
				transform: translateX(0%);
			}
			100% {
				transform: translateX(-50%);
			}
		}

		.animate-fade-in-up {
			animation: fade-in-up 1s ease-out forwards;
		}

		.animate-slide-in-left {
			animation: slide-in-left 0.8s ease-out forwards;
		}

		.animate-slide-in-right {
			animation: slide-in-right 0.8s ease-out forwards;
		}

		.animate-fade-in {
			animation: fade-in 1s ease-out forwards;
		}

		.animate-bounce-slow {
			animation: bounce-slow 3s infinite;
		}

		.animate-pulse {
			animation: pulse 2s infinite;
		}

		.animate-rotate {
			animation: rotate 3s linear infinite;
		}

		.animate-float {
			animation: float 3s ease-in-out infinite;
		}

		.animate-glow {
			animation: glow 2s ease-in-out infinite;
		}

		.animate-shake {
			animation: shake 0.5s ease-in-out;
		}

		.animate-scroll-left {
			animation: scroll-left 30s linear infinite;
		}
		
		.animate-scroll-right {
			animation: scroll-right 30s linear infinite;
		}
		
		.animate-scroll-down {
			animation: scroll-down 30s linear infinite;
		}
		
		.animate-scroll-up {
			animation: scroll-up 30s linear infinite;
		}
		
		.animate-scroll-horizontal {
			animation: scroll-horizontal 20s linear infinite;
		}
		
		.animation-delay-200 {
			animation-delay: 0.2s;
		}
		
		.animation-delay-400 {
			animation-delay: 0.4s;
		}
		
		.animation-delay-600 {
			animation-delay: 0.6s;
		}
		
		.animation-delay-800 {
			animation-delay: 0.8s;
		}


		/* Icon hover effects */
		.icon-hover {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.icon-hover:hover {
			transform: scale(1.1) rotate(5deg);
			color: #ff9015;
		}

		.icon-bounce:hover {
			animation: bounce-slow 0.6s ease-in-out;
		}

		.icon-pulse:hover {
			animation: pulse 1s ease-in-out;
		}

		.icon-float:hover {
			animation: float 2s ease-in-out infinite;
		}

		/* Card hover effects */
		.card-hover {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.card-hover:hover {
			transform: translateY(-5px);
			box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
		}

		/* Service card animations */
		.service-card {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.service-card:hover {
			transform: translateY(-8px);
			box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
		}

		.service-icon {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.service-card:hover .service-icon {
			transform: scale(1.1) rotate(5deg);
		}

		/* Success story animations */
		.success-story-card {
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		}

		.animation-delay-200 {
			animation-delay: 0.2s;
		}

		.animation-delay-400 {
			animation-delay: 0.4s;
		}

		.animation-delay-600 {
			animation-delay: 0.6s;
		}

		.animation-delay-800 {
			animation-delay: 0.8s;
		}

		.animation-delay-1000 {
			animation-delay: 1s;
		}

		.animation-delay-1200 {
			animation-delay: 1.2s;
		}

		/* Language-specific styles */
		[lang="uz"] {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
		}

		[lang="ru"] {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
		}

		[lang="en"] {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
		}

		/* Custom scrollbar */
		::-webkit-scrollbar {
			width: 8px;
		}

		::-webkit-scrollbar-track {
			background: #f1f1f1;
		}

		::-webkit-scrollbar-thumb {
			background: #888;
			border-radius: 4px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: #555;
		}

		/* Mobile optimizations */
		@media (max-width: 768px) {
			.mobile-search-container {
				padding: 0 1rem;
			}

			.mobile-search-title {
				font-size: 1.25rem;
				line-height: 1.5;
			}

			.mobile-dropdown {
				font-size: 0.875rem;
				padding: 0.75rem 1rem;
			}

			/* Mobile more dropdown positioning fix */
			#mobile-more-dropdown {
				left: 50% !important;
				transform: translateX(-50%) !important;
				right: auto !important;
				max-width: calc(100vw - 2rem);
			}

			/* Mobile content padding adjustments */
			.page-container {
				padding-top: 0 !important;
			}

			/* Ensure mobile logo doesn't overlap content - already set above */
		}
	</style>

	{% block extra_css %}{% endblock %}
</head>

<body class="bg-white">
	<!-- Mobile Logo - Center with Blur Effect (Only on Mobile) -->
	<div class="md:hidden fixed top-0 left-0 right-0 z-30 py-2 flex justify-center pointer-events-none">
		<a href="{{ url_for('index') }}" class="mobile-logo-container pointer-events-auto">
			<div class="mobile-logo-blur"></div>
			<img src="/static/images/01.png" alt="Study Fans" class="mobile-logo-img" onerror="this.style.display='none';">
		</a>
	</div>
	
	<style>
		.mobile-logo-container {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
		}
		
		.mobile-logo-blur {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 70px;
			height: 70px;
			background: radial-gradient(circle, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.8) 30%, rgba(255,255,255,0.4) 60%, rgba(255,255,255,0) 100%);
			filter: blur(8px);
			border-radius: 50%;
			z-index: 0;
		}
		
		.mobile-logo-img {
			position: relative;
			z-index: 1;
			width: 40px;
			height: 40px;
			border-radius: 12px;
			object-fit: contain;
		}
	</style>

	<!-- Desktop Sidebar - Left Side -->
	<aside id="sidebar" class="hidden md:flex fixed left-0 top-0 bottom-0 w-56 bg-white border-r border-gray-200 z-50 flex-col transition-all duration-300">
		<!-- Logo - Top -->
		<div class="sidebar-top-section p-6 border-b border-gray-200 relative flex items-center justify-center" style="min-height: 80px;">
			<!-- Toggle Button - Center when collapsed, left when expanded -->
			<button onclick="toggleSidebar()" class="sidebar-toggle-btn z-10 hover:opacity-70 transition-opacity">
				<img id="toggle-icon-close" src="/static/arrow-square-left.svg" alt="Collapse" class="w-5 h-5">
				<img id="toggle-icon-open" src="/static/arrow-square-right.svg" alt="Expand" class="w-5 h-5" style="display: none;">
			</button>
			<!-- Logo - Center when expanded -->
			<a href="{{ url_for('index') }}" class="sidebar-logo flex items-center justify-center absolute left-1/2 -translate-x-1/2">
				<img src="/static/images/01.png" alt="Study Fans" class="sidebar-logo-img w-12 h-12 rounded-xl object-contain transition-all duration-300" onerror="this.style.display='none';">
			</a>
		</div>

		<!-- Navigation Links with Icons - Bottom -->
		<nav class="flex-1 p-3 space-y-2 overflow-y-auto">
			<a href="{{ url_for('index') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'index' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/home.svg" alt="Home" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Bosh sahifa{% elif lang == 'ru' %}Главная{% elif lang == 'tr' %}Ana Sayfa{% else %}Home{% endif %}</span>
			</a>

			<a href="{{ url_for('universities') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'universities' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/book.svg" alt="Universities" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Universitetlar{% elif lang == 'ru' %}Университеты{% elif lang == 'tr' %}Üniversiteler{% else %}Universities{% endif %}</span>
			</a>

			<a href="{{ url_for('services') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'services' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/clipboard.svg" alt="Services" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Xizmatlar{% elif lang == 'ru' %}Услуги{% elif lang == 'tr' %}Hizmetler{% else %}Services{% endif %}</span>
			</a>

			<a href="{{ url_for('success_stories') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'success_stories' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/award.svg" alt="Success Stories" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Muvaffaqiyat hikoyalari{% elif lang == 'ru' %}Истории успеха{% elif lang == 'tr' %}Başarı hikayeleri{% else %}Success Stories{% endif %}</span>
			</a>

			<a href="{{ url_for('about') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'about' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/bookmark.svg" alt="About" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Biz haqimizda{% elif lang == 'ru' %}О нас{% elif lang == 'tr' %}Hakkımızda{% else %}About{% endif %}</span>
			</a>

			<a href="{{ url_for('faq') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'faq' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/messages.svg" alt="FAQ" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}FAQ{% elif lang == 'ru' %}FAQ{% elif lang == 'tr' %}SSS{% else %}FAQ{% endif %}</span>
			</a>

			<a href="{{ url_for('calculator') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'calculator' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/calculator.svg" alt="Calculator" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Kalkulyator{% elif lang == 'ru' %}Калькулятор{% elif lang == 'tr' %}Hesap Makinesi{% else %}Calculator{% endif %}</span>
			</a>

			<a href="{{ url_for('video_gallery') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'video_gallery' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/video-play.svg" alt="Video Gallery" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Video Galereya{% elif lang == 'ru' %}Видео Галерея{% elif lang == 'tr' %}Video Galeri{% else %}Video Gallery{% endif %}</span>
			</a>

			<a href="{{ url_for('certificates') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'certificates' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/verify.svg" alt="Certificates" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Sertifikatlar{% elif lang == 'ru' %}Сертификаты{% elif lang == 'tr' %}Sertifikalar{% else %}Certificates{% endif %}</span>
			</a>

			<a href="{{ url_for('chat') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'chat' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/microscope.svg" alt="AI Chat" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Study Fans AI{% elif lang == 'ru' %}Study Fans AI{% elif lang == 'tr' %}Study Fans AI{% else %}Study Fans AI{% endif %}</span>
			</a>

			<a href="{{ url_for('blog', lang=lang) }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 {% if request.endpoint in ['blog', 'blog_detail'] %}active{% endif %} relative" data-lang="{{ lang }}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/clipboard-text.svg" alt="Blog" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Blog{% elif lang == 'ru' %}Блог{% elif lang == 'tr' %}Blog{% else %}Blog{% endif %}</span>
			</a>

			<a href="{{ url_for('partner') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'partner' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/people.svg" alt="Partner" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Hamkor{% elif lang == 'ru' %}Партнер{% elif lang == 'tr' %}Ortak{% else %}Partner{% endif %}</span>
			</a>

			<a href="{{ url_for('contact') }}"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative {% if request.endpoint == 'contact' %}active{% endif %}">
				<div class="sidebar-icon-wrapper">
					<img src="/static/sms-tracking.svg" alt="Contact" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Aloqa{% elif lang == 'ru' %}Контакты{% elif lang == 'tr' %}İletişim{% else %}Contact{% endif %}</span>
			</a>

			<a href="tel:+905011571111"
				class="sidebar-link flex items-center py-2 text-sm font-normal text-gray-900 relative">
				<div class="sidebar-icon-wrapper">
					<img src="/static/call-calling.svg" alt="Consultation" class="w-5 h-5 sidebar-icon">
				</div>
				<span class="sidebar-text transition-all duration-300">{% if lang == 'uz' %}Konsultatsiya{% elif lang == 'ru' %}Консультация{% elif lang == 'tr' %}Danışmanlık{% else %}Consultation{% endif %}</span>
			</a>
		</nav>

		<!-- Language Switcher - Bottom -->
		<div class="p-4 border-t border-gray-200">
			<div class="relative group">
				<button class="w-full flex items-center justify-between px-4 py-3 text-sm font-light text-gray-900 rounded-xl hover:bg-gray-50 transition-colors">
					<span>{% if lang == 'uz' %}UZ{% elif lang == 'en' %}EN{% elif lang == 'ru' %}RU{% else %}TR{% endif %}</span>
					<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-gray-400 transition-transform group-hover:rotate-180">
						<polyline points="6,9 12,15 18,9"/>
					</svg>
				</button>
				<div class="absolute bottom-full left-0 right-0 mb-2 bg-white border border-gray-200 rounded-xl shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
					<a href="{{ request.url | replace_query_param('lang', 'uz') }}" 
						class="block px-4 py-3 text-sm font-light text-gray-900 hover:bg-gray-50 rounded-t-xl transition-colors {% if lang == 'uz' %}bg-gray-50{% endif %}">
						UZ
					</a>
					<a href="{{ request.url | replace_query_param('lang', 'en') }}" 
						class="block px-4 py-3 text-sm font-light text-gray-900 hover:bg-gray-50 transition-colors {% if lang == 'en' %}bg-gray-50{% endif %}">
						EN
					</a>
					<a href="{{ request.url | replace_query_param('lang', 'ru') }}" 
						class="block px-4 py-3 text-sm font-light text-gray-900 hover:bg-gray-50 transition-colors {% if lang == 'ru' %}bg-gray-50{% endif %}">
						RU
					</a>
					<a href="{{ request.url | replace_query_param('lang', 'tr') }}" 
						class="block px-4 py-3 text-sm font-light text-gray-900 hover:bg-gray-50 rounded-b-xl transition-colors {% if lang == 'tr' %}bg-gray-50{% endif %}">
						TR
					</a>
				</div>
			</div>
		</div>
	</aside>

	<!-- Mobile Bottom Navigation -->
	<nav class="md:hidden fixed bottom-0 left-0 right-0 z-40 bg-white border-t border-gray-200 safe-area-bottom">
		<div class="flex items-center justify-around h-16 px-2">
			<!-- Home -->
			<a href="{{ url_for('index') }}" class="flex flex-col items-center justify-center flex-1 py-2 {% if request.endpoint == 'index' %}text-gray-900{% else %}text-gray-400{% endif %} transition-colors">
				<img src="/static/home.svg" alt="Home" class="w-5 h-5 mb-1">
				<span class="text-xs font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">{% if lang == 'uz' %}Asosiy{% elif lang == 'ru' %}Главная{% elif lang == 'tr' %}Ana{% else %}Home{% endif %}</span>
			</a>

			<!-- Universities -->
			<a href="{{ url_for('universities') }}" class="flex flex-col items-center justify-center flex-1 py-2 {% if request.endpoint == 'universities' %}text-gray-900{% else %}text-gray-400{% endif %} transition-colors">
				<img src="/static/book.svg" alt="Universities" class="w-5 h-5 mb-1">
				<span class="text-xs font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">{% if lang == 'uz' %}Universitetlar{% elif lang == 'ru' %}Университеты{% elif lang == 'tr' %}Üniversiteler{% else %}Universities{% endif %}</span>
			</a>

			<!-- Services -->
			<a href="{{ url_for('services') }}" class="flex flex-col items-center justify-center flex-1 py-2 {% if request.endpoint == 'services' %}text-gray-900{% else %}text-gray-400{% endif %} transition-colors">
				<img src="/static/clipboard.svg" alt="Services" class="w-5 h-5 mb-1">
				<span class="text-xs font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">{% if lang == 'uz' %}Xizmatlar{% elif lang == 'ru' %}Услуги{% elif lang == 'tr' %}Hizmetler{% else %}Services{% endif %}</span>
			</a>

			<!-- Study Fans AI -->
			<a href="{{ url_for('chat') }}" class="flex flex-col items-center justify-center flex-1 py-2 {% if request.endpoint == 'chat' %}text-gray-900{% else %}text-gray-400{% endif %} transition-colors">
				<img src="/static/microscope.svg" alt="AI Chat" class="w-5 h-5 mb-1">
				<span class="text-xs font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">{% if lang == 'uz' %}Study Fans AI{% elif lang == 'ru' %}Study Fans AI{% elif lang == 'tr' %}Study Fans AI{% else %}Study Fans AI{% endif %}</span>
			</a>

			<!-- More Button with Dropdown -->
			<div class="relative flex flex-col items-center justify-center flex-1">
				<button onclick="toggleMobileMoreDropdown()" class="flex flex-col items-center justify-center w-full py-2 text-gray-400 transition-colors">
					<img src="/static/more-square.svg" alt="More" class="w-5 h-5 mb-1">
					<span class="text-xs font-normal" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">{% if lang == 'uz' %}Ko'proq{% elif lang == 'ru' %}Еще{% elif lang == 'tr' %}Daha{% else %}More{% endif %}</span>
				</button>
				
				<!-- Dropdown Menu - Fixed positioning for mobile -->
				<div id="mobile-more-dropdown" class="fixed bottom-20 left-1/2 -translate-x-1/2 mb-2 w-[calc(100vw-2rem)] max-w-sm bg-white border border-gray-200 rounded-2xl shadow-xl z-50 hidden" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;">
					<div class="py-2">
						<a href="{{ url_for('faq') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'faq' %}bg-gray-50{% endif %}">
							<img src="/static/messages.svg" alt="FAQ" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}FAQ{% elif lang == 'ru' %}FAQ{% elif lang == 'tr' %}SSS{% else %}FAQ{% endif %}</span>
						</a>

						<a href="{{ url_for('calculator') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'calculator' %}bg-gray-50{% endif %}">
							<img src="/static/calculator.svg" alt="Calculator" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Kalkulyator{% elif lang == 'ru' %}Калькулятор{% elif lang == 'tr' %}Hesap Makinesi{% else %}Calculator{% endif %}</span>
						</a>

						<a href="{{ url_for('video_gallery') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'video_gallery' %}bg-gray-50{% endif %}">
							<img src="/static/video-play.svg" alt="Video Gallery" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Video Galereya{% elif lang == 'ru' %}Видео Галерея{% elif lang == 'tr' %}Video Galeri{% else %}Video Gallery{% endif %}</span>
						</a>

						<a href="{{ url_for('certificates') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'certificates' %}bg-gray-50{% endif %}">
							<img src="/static/verify.svg" alt="Certificates" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Sertifikatlar{% elif lang == 'ru' %}Сертификаты{% elif lang == 'tr' %}Sertifikalar{% else %}Certificates{% endif %}</span>
						</a>

						<a href="{{ url_for('blog', lang=lang) }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint in ['blog', 'blog_detail'] %}bg-gray-50{% endif %}">
							<img src="/static/clipboard-text.svg" alt="Blog" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Blog{% elif lang == 'ru' %}Блог{% elif lang == 'tr' %}Blog{% else %}Blog{% endif %}</span>
						</a>

						<a href="{{ url_for('partner') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'partner' %}bg-gray-50{% endif %}">
							<img src="/static/people.svg" alt="Partner" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Hamkor{% elif lang == 'ru' %}Партнер{% elif lang == 'tr' %}Ortak{% else %}Partner{% endif %}</span>
						</a>

						<a href="{{ url_for('success_stories') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'success_stories' %}bg-gray-50{% endif %}">
							<img src="/static/award.svg" alt="Success Stories" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Muvaffaqiyat hikoyalari{% elif lang == 'ru' %}Истории успеха{% elif lang == 'tr' %}Başarı hikayeleri{% else %}Success Stories{% endif %}</span>
						</a>

						<a href="{{ url_for('about') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'about' %}bg-gray-50{% endif %}">
							<img src="/static/bookmark.svg" alt="About" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Biz haqimizda{% elif lang == 'ru' %}О нас{% elif lang == 'tr' %}Hakkımızda{% else %}About{% endif %}</span>
						</a>

						<a href="{{ url_for('contact') }}" class="flex items-center space-x-3 px-4 py-2.5 text-sm font-normal text-gray-900 hover:bg-gray-50 transition-colors {% if request.endpoint == 'contact' %}bg-gray-50{% endif %}">
							<img src="/static/call-calling.svg" alt="Contact" class="w-4 h-4 flex-shrink-0">
							<span>{% if lang == 'uz' %}Aloqa{% elif lang == 'ru' %}Контакты{% elif lang == 'tr' %}İletişim{% else %}Contact{% endif %}</span>
						</a>

						<div class="border-t border-gray-200 my-1"></div>

						<div class="px-4 py-2.5">
							<div class="flex items-center justify-between mb-2">
								<span class="text-xs font-medium text-gray-700">{% if lang == 'uz' %}Til{% elif lang == 'ru' %}Язык{% elif lang == 'tr' %}Dil{% else %}Language{% endif %}</span>
							</div>
							<div class="flex items-center gap-1.5">
								<a href="{{ request.url | replace_query_param('lang', 'uz') }}" class="px-2.5 py-1 text-xs font-normal rounded-full {% if lang == 'uz' %}bg-gray-900 text-white{% else %}bg-gray-100 text-gray-600{% endif %} transition-colors">UZ</a>
								<a href="{{ request.url | replace_query_param('lang', 'en') }}" class="px-2.5 py-1 text-xs font-normal rounded-full {% if lang == 'en' %}bg-gray-900 text-white{% else %}bg-gray-100 text-gray-600{% endif %} transition-colors">EN</a>
								<a href="{{ request.url | replace_query_param('lang', 'ru') }}" class="px-2.5 py-1 text-xs font-normal rounded-full {% if lang == 'ru' %}bg-gray-900 text-white{% else %}bg-gray-100 text-gray-600{% endif %} transition-colors">RU</a>
								<a href="{{ request.url | replace_query_param('lang', 'tr') }}" class="px-2.5 py-1 text-xs font-normal rounded-full {% if lang == 'tr' %}bg-gray-900 text-white{% else %}bg-gray-100 text-gray-600{% endif %} transition-colors">TR</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<!-- Flash Messages -->
	{% with messages = get_flashed_messages(with_categories=true) %}
		{% if messages %}
			<div class="fixed top-20 right-4 z-50 space-y-2">
				{% for category, message in messages %}
					<div class="bg-{% if category == 'success' %}green{% elif category == 'error' %}red{% else %}blue{% endif %}-500 text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full" id="flash-{{ loop.index }}">
						<div class="flex items-center justify-between">
							<span>{{ message }}</span>
							<button onclick="closeFlash({{ loop.index }})" class="ml-4 text-white hover:text-gray-200">
								<i class="fas fa-times"></i>
							</button>
						</div>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	{% endwith %}

	<!-- Flash Messages -->
	{% with messages = get_flashed_messages(with_categories=true) %}
		{% if messages %}
			<div class="fixed top-20 right-4 z-50 space-y-2">
				{% for category, message in messages %}
					<div class="bg-{% if category == 'success' %}green{% else %}red{% endif %}-500 text-white px-6 py-4 rounded-lg shadow-lg max-w-md animate-fade-in-up">
						<div class="flex items-center">
							<i class="fas fa-{% if category == 'success' %}check-circle{% else %}exclamation-circle{% endif %} mr-3"></i>
							<span>{{ message }}</span>
						</div>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	{% endwith %}

	<!-- Success Modal -->
	<div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
		<div class="bg-white rounded-3xl p-8 max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0" id="successModalContent">
			<div class="text-center">
				<div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
					<i class="fas fa-check-circle text-4xl text-green-500"></i>
				</div>
				<h3 class="text-2xl font-bold text-gray-900 mb-4">
					{% if lang == 'uz' %}Muvaffaqiyat!{% elif lang == 'ru' %}Успешно!{% elif lang == 'tr' %}Başarılı!{% else %}Success!{% endif %}
				</h3>
				<p class="text-gray-600 mb-6" id="successMessage">
					{% if lang == 'uz' %}Arizangiz muvaffaqiyatli yuborildi! Tez orada siz bilan bog'lanamiz.{% elif lang == 'ru' %}Ваша заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.{% elif lang == 'tr' %}Başvurunuz başarıyla gönderildi! Yakında sizinle iletişime geçeceğiz.{% else %}Your application has been sent successfully! We will contact you soon.{% endif %}
				</p>
				<div class="bg-blue-50 rounded-xl p-4 mb-6">
					<p class="text-sm text-gray-600 mb-2">
						{% if lang == 'uz' %}Agar savollaringiz bo'lsa, biz bilan bog'laning:{% elif lang == 'ru' %}Если у вас есть вопросы, свяжитесь с нами:{% elif lang == 'tr' %}Sorularınız varsa bizimle iletişime geçin:{% else %}If you have questions, contact us:{% endif %}
					</p>
					<p class="text-lg font-semibold text-blue-600">+998 90 123 45 67</p>
				</div>
				<button onclick="closeSuccessModal()" class="w-full bg-gradient-to-r from-green-400 to-green-500 hover:from-green-500 hover:to-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
					{% if lang == 'uz' %}Yopish{% elif lang == 'ru' %}Закрыть{% elif lang == 'tr' %}Kapat{% else %}Close{% endif %}
				</button>
			</div>
		</div>
	</div>

	<!-- Error Modal -->
	<div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
		<div class="bg-white rounded-3xl p-8 max-w-md w-full mx-4 transform transition-all duration-300 scale-95 opacity-0" id="errorModalContent">
			<div class="text-center">
				<div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
					<i class="fas fa-exclamation-triangle text-4xl text-red-500"></i>
				</div>
				<h3 class="text-2xl font-bold text-gray-900 mb-4">
					{% if lang == 'uz' %}Xatolik!{% elif lang == 'ru' %}Ошибка!{% elif lang == 'tr' %}Hata!{% else %}Error!{% endif %}
				</h3>
				<p class="text-gray-600 mb-6" id="errorMessage">
					{% if lang == 'uz' %}Xatolik yuz berdi. Iltimos, qaytadan urinib ko'ring.{% elif lang == 'ru' %}Произошла ошибка. Пожалуйста, попробуйте еще раз.{% elif lang == 'tr' %}Bir hata oluştu. Lütfen tekrar deneyin.{% else %}An error occurred. Please try again.{% endif %}
				</p>
				<div class="bg-red-50 rounded-xl p-4 mb-6">
					<p class="text-sm text-gray-600 mb-2">
						{% if lang == 'uz' %}Agar muammo davom etsa, telefon orqali bog'laning:{% elif lang == 'ru' %}Если проблема продолжается, свяжитесь с нами по телефону:{% elif lang == 'tr' %}Sorun devam ederse telefon ile iletişime geçin:{% else %}If the problem continues, contact us by phone:{% endif %}
					</p>
					<p class="text-lg font-semibold text-red-600">+998 90 123 45 67</p>
				</div>
				<button onclick="closeErrorModal()" class="w-full bg-gradient-to-r from-red-400 to-red-500 hover:from-red-500 hover:to-red-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
					{% if lang == 'uz' %}Yopish{% elif lang == 'ru' %}Закрыть{% elif lang == 'tr' %}Kapat{% else %}Close{% endif %}
				</button>
			</div>
		</div>
	</div>

	<!-- Main Content - Adjusted for Sidebar with Space -->
	<main id="main-content" class="bg-white min-h-screen relative z-10 md:pt-0 pt-16">
		{% block content %}{% endblock %}
	</main>


	<!-- Scripts -->
	<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
	<script>
		// Initialize AOS
		AOS.init({
			duration: 1000,
			once: true,
			offset: 100
		});

		// Sidebar toggle function
		function toggleSidebar() {
			const sidebar = document.getElementById('sidebar');
			const mainContent = document.getElementById('main-content');
			
			if (sidebar && mainContent) {
				// Add transition class to prevent layout shift
				sidebar.style.transition = 'width 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
				mainContent.style.transition = 'margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
				
				// Toggle collapsed state
				const isCollapsed = sidebar.classList.contains('sidebar-collapsed');
				sidebar.classList.toggle('sidebar-collapsed');
				
				// Update main content class to match sidebar state
				if (!isCollapsed) {
					// Collapsing - sidebar yopilmoqda
					mainContent.classList.add('sidebar-content-collapsed');
				} else {
					// Expanding - sidebar ochilmoqda
					mainContent.classList.remove('sidebar-content-collapsed');
				}
			}
		}
		
		// Initialize sidebar state on page load
		document.addEventListener('DOMContentLoaded', function() {
			const sidebar = document.getElementById('sidebar');
			const mainContent = document.getElementById('main-content');
			
			if (sidebar && mainContent) {
				// Check if sidebar is collapsed on page load
				if (sidebar.classList.contains('sidebar-collapsed')) {
					mainContent.classList.add('sidebar-content-collapsed');
				}
			}
		});

		// Mobile more dropdown toggle
		function toggleMobileMoreDropdown() {
			const dropdown = document.getElementById('mobile-more-dropdown');
			if (dropdown) {
				dropdown.classList.toggle('hidden');
			}
		}
		
		// Close dropdown when clicking outside
		document.addEventListener('click', function(event) {
			const dropdown = document.getElementById('mobile-more-dropdown');
			const button = event.target.closest('[onclick="toggleMobileMoreDropdown()"]');
			
			if (dropdown && !dropdown.contains(event.target) && !button) {
				dropdown.classList.add('hidden');
			}
		});

		// Flash message auto-close
		function closeFlash(index) {
			const flash = document.getElementById('flash-' + index);
			if (flash) {
				flash.style.transform = 'translateX(100%)';
				setTimeout(() => {
					flash.remove();
				}, 300);
			}
		}

		// Auto-close flash messages after 5 seconds
		document.addEventListener('DOMContentLoaded', function() {
			const flashMessages = document.querySelectorAll('[id^="flash-"]');
			flashMessages.forEach((flash, index) => {
				setTimeout(() => {
					closeFlash(index + 1);
				}, 5000);
			});
		});

		// Smooth scrolling for anchor links
		document.querySelectorAll('a[href^="#"]').forEach(anchor => {
			anchor.addEventListener('click', function (e) {
				e.preventDefault();
				const target = document.querySelector(this.getAttribute('href'));
				if (target) {
					target.scrollIntoView({
						behavior: 'smooth',
						block: 'start'
					});
				}
			});
		});

		// Language switching with persistence
		function switchLanguage(lang) {
			// Save language preference to localStorage
			localStorage.setItem('preferred_language', lang);
			
			const currentUrl = new URL(window.location);
			currentUrl.searchParams.set('lang', lang);
			window.location.href = currentUrl.toString();
		}

		// Load saved language preference on page load
		document.addEventListener('DOMContentLoaded', function() {
			const savedLang = localStorage.getItem('preferred_language');
			const currentLang = new URLSearchParams(window.location.search).get('lang');
			
			// Always update localStorage with current URL language if it exists
			if (currentLang) {
				localStorage.setItem('preferred_language', currentLang);
			}
			// If no language is specified in URL and we have a saved preference, redirect
			else if (savedLang) {
				const currentUrl = new URL(window.location);
				currentUrl.searchParams.set('lang', savedLang);
				window.location.href = currentUrl.toString();
			}

			// Auto-hide flash messages after 5 seconds
			const flashMessages = document.querySelectorAll('.fixed.top-20.right-4 .bg-green-500, .fixed.top-20.right-4 .bg-red-500');
			flashMessages.forEach(function(message) {
				setTimeout(function() {
					message.style.opacity = '0';
					message.style.transform = 'translateX(100%)';
					setTimeout(function() {
						message.remove();
					}, 300);
				}, 5000);
			});

			// Check for success/error parameters in URL and show modals
			const urlParams = new URLSearchParams(window.location.search);
			const success = urlParams.get('success');
			const error = urlParams.get('error');
			
			if (success === 'true') {
				showSuccessModal();
				// Remove success parameter from URL
				urlParams.delete('success');
				window.history.replaceState({}, '', window.location.pathname + (urlParams.toString() ? '?' + urlParams.toString() : ''));
			} else if (error === 'true') {
				showErrorModal();
				// Remove error parameter from URL
				urlParams.delete('error');
				window.history.replaceState({}, '', window.location.pathname + (urlParams.toString() ? '?' + urlParams.toString() : ''));
			}
		});

		// Modal functions
		function showSuccessModal() {
			const modal = document.getElementById('successModal');
			const content = document.getElementById('successModalContent');
			modal.classList.remove('hidden');
			setTimeout(() => {
				content.classList.remove('scale-95', 'opacity-0');
				content.classList.add('scale-100', 'opacity-100');
			}, 10);
		}

		function closeSuccessModal() {
			const modal = document.getElementById('successModal');
			const content = document.getElementById('successModalContent');
			content.classList.remove('scale-100', 'opacity-100');
			content.classList.add('scale-95', 'opacity-0');
			setTimeout(() => {
				modal.classList.add('hidden');
			}, 300);
		}

		function showErrorModal() {
			const modal = document.getElementById('errorModal');
			const content = document.getElementById('errorModalContent');
			modal.classList.remove('hidden');
			setTimeout(() => {
				content.classList.remove('scale-95', 'opacity-0');
				content.classList.add('scale-100', 'opacity-100');
			}, 10);
		}

		function closeErrorModal() {
			const modal = document.getElementById('errorModal');
			const content = document.getElementById('errorModalContent');
			content.classList.remove('scale-100', 'opacity-100');
			content.classList.add('scale-95', 'opacity-0');
			setTimeout(() => {
				modal.classList.add('hidden');
			}, 300);
		}

		// Close modals when clicking outside
		document.getElementById('successModal').addEventListener('click', function(e) {
			if (e.target === this) {
				closeSuccessModal();
			}
		});

		document.getElementById('errorModal').addEventListener('click', function(e) {
			if (e.target === this) {
				closeErrorModal();
			}
		});

		// Counter Animation Function
		function animateCounter(element) {
			const target = parseInt(element.getAttribute('data-target'));
			const suffix = element.getAttribute('data-suffix') || '';
			const duration = 2000;
			const startTime = performance.now();

			function updateCounter(currentTime) {
				const elapsed = currentTime - startTime;
				const progress = Math.min(elapsed / duration, 1);
				
				// Easing function for smooth animation
				const easedProgress = 1 - Math.pow(1 - progress, 3);
				const current = Math.floor(target * easedProgress);

				// Format display value
				let displayValue;
				if (suffix === 'k+') {
					displayValue = Math.floor(current / 1000);
				} else {
					displayValue = current;
				}

				element.textContent = displayValue + suffix;

				if (progress < 1) {
					requestAnimationFrame(updateCounter);
				}
			}

			requestAnimationFrame(updateCounter);
		}

		// Start counter animation when stats section is visible
		function startCounterAnimation() {
			const counters = document.querySelectorAll('.counter');
			counters.forEach(counter => {
				if (!counter.classList.contains('animated')) {
					counter.classList.add('animated');
					// Small delay for each counter
					setTimeout(() => {
						animateCounter(counter);
					}, 200);
				}
			});
		}

		// Intersection Observer for stats section
		const statsObserver = new IntersectionObserver((entries) => {
			entries.forEach(entry => {
				if (entry.isIntersecting) {
					startCounterAnimation();
					statsObserver.unobserve(entry.target); // Only animate once
				}
			});
		}, {
			threshold: 0.5
		});

		// Test animation immediately (remove this later)
		setTimeout(() => {
			console.log('Testing counter animation...');
			startCounterAnimation();
		}, 1000);

		// Coming Soon function
		function showComingSoon(event) {
			event.preventDefault();
			const lang = event.currentTarget.getAttribute('data-lang') || 'uz';
			const messages = {
				'uz': 'Tez orada ishga tushadi',
				'ru': 'Скоро будет доступно',
				'tr': 'Yakında kullanılabilir',
				'en': 'Coming soon'
			};
			alert(messages[lang] || messages['uz']);
			return false;
		}

		// Also observe stats section
		setTimeout(() => {
			const statsSection = document.getElementById('stats-section');
			if (statsSection) {
				console.log('Stats section found, observing...');
				statsObserver.observe(statsSection);
			} else {
				console.log('Stats section not found');
			}
		}, 100);
	</script>
	
	<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

	{% block extra_js %}{% endblock %}
</body>

</html>
